<!DOCTYPE html>
<html>

<head>
    <title>Feed U - Vendor Page</title>

    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="stylesheet" href="../css/base.css" />
    <script src="../bundle.js"></script>

</head>

<body>
    <div data-role="page" id="vendor-page">
        <style>
            body {
                font-family: "Poppins";
            }

            .container {
                display: flex;
                flex-direction: column;
            }

            .item_poi_container {
                display: flex;
                flex: 1 1 auto;
                margin-bottom: 2.5%;
            }

            .poi_text_content {
                display: flex;
                width: 100%;
            }

            .poi_details {
                display: flex;
                flex-direction:
                    column;
                margin-left: 5%;
            }

            .poi_title_description {
                width: 92%;
                text-align: justify;
                text-justify: inter-word;
            }

            #poi_title {
                margin: 0;
                font-size: 14px;
            }

            #poi_description {
                margin-top: 4%;
                margin-bottom: 4%;
                margin-left: 0;
                margin-right: 0;
                font-size: 11px;
            }

            .poi_ratings_bar {
                display: flex;
                align-items: center;
                height: 20px;
                width: 70px;
                font-size: 11px;
                background: #F2F2F2;
                border-radius: 25px;
            }

            #poi_ratings_image {
                margin-top: 2%;
            }

            #poi_ratings_text {
                margin-left: 3%;
            }

            .poi_price_tag {
                width: 60%;
            }

            #poi_price {
                text-align: right;
                font-size: 14px;
                margin: 0;
            }

            a:link {
                text-decoration: none;
                color: black;
            }

            /* visited link */
            a:visited {
                text-decoration: none;
                color: black;
            }

            /* mouse over link */
            a:hover {
                text-decoration: none;
                color: black;
            }

            /* selected link */
            a:active {
                text-decoration: none;
                color: black;
            }
        </style>
        <div data-role="header" data-position="fixed" data-add-back-btn="true">
            <!-- <a href="#" data-icon="back" class="ui-btn-left">Back</a> -->
            <h1>Header Bar</h1>
        </div>
        <div role="main" class="ui-content">
            <div style="position: relative; margin-bottom: 1em;">
                <img id="vendor-page-vendor-image" style="display:block; width: 100%; height: auto; margin: 0;"
                    src="../assets/vendor_page_images/burgers_ahouy.jpg">
                <div style="
                    position: absolute;
                    bottom: 0;
                    padding-top: 0.25em;
                    padding-bottom: 0.25em;
                    font-weight: 100;
                    background: rgba(0, 0, 0, 0.5); /* Black see-through */
                    color: #f1f1f1;
                    width: 100%;
                    opacity:1;
                    text-align: left;">
                    <div style="display: flex; justify-content: space-between; text-shadow: none;">
                        <div style="margin-left: 1em;">
                            <span id="vendor-page-vendor-title" style="font-size: 18px;">Burgers Ahouy!</span><br>
                            <span id="vendor-page-vendor-location" style="font-size: 12px;">COLOMBO 3 </span>
                            <span id="vendor-page-vendor-delivery-time" style="font-size: 12px;">(25 - 30 MIN)</span>
                        </div>
                        <div style="margin-right: 1em;">
                            <svg width="32" height="32" viewBox="0 0 32 32" fill="none"
                                xmlns="http://www.w3.org/2000/svg">
                                <path
                                    d="M17.5552 9.72095C19.3297 7.80275 22.1053 7.56537 23.9298 9.19405L23.93 9.19419C26.1205 11.1535 26.2444 14.7096 24.2702 16.844L24.27 16.8442L16.2078 25.5653C16.2078 25.5654 16.2077 25.5654 16.2076 25.5655C16.1359 25.643 16.06 25.6666 15.9982 25.6666C15.9364 25.6666 15.8605 25.643 15.7888 25.5655C15.7887 25.5654 15.7887 25.5654 15.7886 25.5653L7.72684 16.8447C5.75589 14.7101 5.87998 11.1532 8.07089 9.19393C9.89576 7.56503 12.675 7.8034 14.4447 9.72022L14.4459 9.72143L15.2667 10.6075L16.0003 11.3995L16.7339 10.6075L17.5547 9.72143L17.5552 9.72095Z"
                                    stroke="white" stroke-width="2" />
                            </svg>
                        </div>
                    </div>
                </div>
            </div>

            <div style="font-size: 12px;">
                <svg width="5" height="5" viewBox="0 0 5 5" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <circle r="2.5" transform="matrix(1 0 0 -1 2.5 2.5)" fill="#C4C4C4" />
                </svg>
                Burgers
                <svg style="margin-left: 2%;" width="5" height="5" viewBox="0 0 5 5" fill="none"
                    xmlns="http://www.w3.org/2000/svg">
                    <circle r="2.5" transform="matrix(1 0 0 -1 2.5 2.5)" fill="#C4C4C4" />
                </svg>
                American
            </div>
            <div style="display: flex;
			align-items: center;
			font-size: 11px;">
                <p><svg id="poi_ratings_image" width="12" height="11" viewBox="0 0 12 11" fill="none"
                        xmlns="http://www.w3.org/2000/svg">
                        <path
                            d="M6 0L7.34708 4.1459H11.7063L8.17963 6.7082L9.52671 10.8541L6 8.2918L2.47329 10.8541L3.82037 6.7082L0.293661 4.1459H4.65292L6 0Z"
                            fill="#F2C94C" />
                    </svg>
                    <span id="vendor-page-vendor-rating-value">0.0</span>
                <p id="vendor-page-vendor-no-of-ratings">(0)</p>
                <p style="margin-left: 1.25em;">View Comments</p>
                </p>
            </div>
            <!-- Gamification process section  -->
            <div data-role="popup" id="popup" data-overlay-theme="b" data-theme="b" data-corners="false" style="padding: 1em;">
                <p> Rewards Offered </p>
                <hr>
                <h3>How obtain a reward</h3>
                <p>3 orders earns a LKR 350 reward</p>
                <h3>Reward At</h3>
                <p>Burgers Ahoy!</p>
                <h3>Details</h3>
                <p>Rewards expire 60 days after you earn them. They can be used only once, on a single order, and
                    cannot be combined with any other offer.
            
                    If a restaurant cancels this programme after you started earning rewards, you’ll have 30 days to
                    finish earning the reward and 60 days to use any rewards you’ve earned at that restaurant.</p>
                    <!-- OK button with close action -->
                <a data-rel="back">
                    <button id="okBtn"
                        style="width: 100%; text-align: center; background: #EB5757; color: white; margin: 0px; padding: 0px; border-radius: 0%; text-shadow: none;">
                        <h4> OK</h4>
                    </button>
                </a>
                <!-- </div> -->
            </div>
            <a href="#popup" data-rel="popup" data-position-to="window" data-transition="fade"><img
                    class="popphoto" src="../_assets/img/paris.jpg" alt="" style="width:30%;">
                <div
                    style="border:1px solid gray; border-width: thin; display: flex; flex-direction: column; padding-left: 10px; padding-right: 10px; padding-top: 10px; padding-bottom: 10px;">
                    <div style="display: flex; justify-content: space-evenly;">
                        <div style="display: flex; align-items: center;"><i class="fa fa-adjust" aria-hidden="true"
                                style="color: #EB5757;"></i></div>

                        <div style="display:flex; flex-direction: column; margin-left: 1em;">
                            <h5 style="margin: 0;">3 orders earns a LKR 350 reward <br>LKR 750 minimum</h5>
                        </div>

                        <div style="display: flex; align-items: center; margin-left: 1em;"><i class="fa fa-angle-right"
                                aria-hidden="true" style="color: #EB5757;"></i></div>
                    </div>
                    <!-- progress bar -->
                    <div style="display: flex; justify-content: center; margin-top: 0.5em;">
                        <div style="background-color: #EB5757; width: 60px; height: 6px;"></div>
                        <div style="background-color: #C4C4C4; width: 50px; height: 6px; margin-left: 0.5em;"></div>
                        <div style="background-color: #C4C4C4; width: 50px; height: 6px; margin-left: 0.5em;"></div>
                        <div style="background-color: #C4C4C4; width: 50px; height: 6px; margin-left: 0.5em;"></div>
                    </div>
                </div>
            </a>
            <br>
            <div id="vendor-page-container" class="container">
                <!-- <div class="poi_container">
                    <div>
                        <img src="../assets/vendor_page_images/tom_yum_soup.jpg">
                    </div>
                    <div class="poi_text_content">
                        <div class="poi_details">
                            <div class="poi_title_description">
                                <p id="poi_title">Tom Yum Soup</p>
                                <p id="poi_description">Picked from the fresh vegetables and fish from the with special
                                    Chicken Broth.</p>
                            </div>
                            <div class="poi_ratings_bar">
                                <p id="poi_ratings_text"><svg id="poi_ratings_image" width="12" height="11"
                                        viewBox="0 0 12 11" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <path
                                            d="M6 0L7.34708 4.1459H11.7063L8.17963 6.7082L9.52671 10.8541L6 8.2918L2.47329 10.8541L3.82037 6.7082L0.293661 4.1459H4.65292L6 0Z"
                                            fill="#F2C94C" />
                                    </svg>&nbsp;&nbsp;4.6&nbsp;
                                <p>(47)</p>
                                </p>
                            </div>
                        </div>
                        <div class="poi_price_tag">
                            <p id="poi_price">LKR 800</p>
                        </div>
                    </div>
                </div> -->
                <!-- <div class="poi_container">
                    <div>
                        <img src="../assets/vendor_page_images/crispy_chicken_burger.jpg">
                    </div>
                    <div class="poi_text_content">
                        <div class="poi_details">
                            <div class="poi_title_description">
                                <p id="poi_title">Crispy Chicken Burger</p>
                                <p id="poi_description">Crispy, Chicky, Crispy Chicken Burger. It’s pretty much
                                    self-explanatory.</p>
                            </div>
                            <div class="poi_ratings_bar">
                                <p id="poi_ratings_text"><svg id="poi_ratings_image" width="12" height="11"
                                        viewBox="0 0 12 11" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <path
                                            d="M6 0L7.34708 4.1459H11.7063L8.17963 6.7082L9.52671 10.8541L6 8.2918L2.47329 10.8541L3.82037 6.7082L0.293661 4.1459H4.65292L6 0Z"
                                            fill="#F2C94C" />
                                    </svg>&nbsp;&nbsp;4.0&nbsp;
                                <p>(10)</p>
                                </p>
                            </div>
                        </div>
                        <div class="poi_price_tag">
                            <p id="poi_price">LKR 450</p>
                        </div>
                    </div>
                </div>
                <div class="poi_container">
                    <div>
                        <img src="../assets/vendor_page_images/hawaiian_burger.jpg">
                    </div>
                    <div class="poi_text_content">
                        <div class="poi_details">
                            <div class="poi_title_description">
                                <p id="poi_title">Hawaiian Burger</p>
                                <p id="poi_description">Yes! Pineapples go on burgers too. Don’t let others tell you
                                    otherwise.</p>
                            </div>
                            <div class="poi_ratings_bar">
                                <p id="poi_ratings_text"><svg id="poi_ratings_image" width="12" height="11"
                                        viewBox="0 0 12 11" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <path
                                            d="M6 0L7.34708 4.1459H11.7063L8.17963 6.7082L9.52671 10.8541L6 8.2918L2.47329 10.8541L3.82037 6.7082L0.293661 4.1459H4.65292L6 0Z"
                                            fill="#F2C94C" />
                                    </svg>&nbsp;&nbsp;4.8&nbsp;
                                <p>(45)</p>
                                </p>
                            </div>
                        </div>
                        <div class="poi_price_tag">
                            <p id="poi_price">LKR 600</p>
                        </div>
                    </div>
                </div> -->
            </div>
        </div>
        <!--
            PROBLEM: this footer seems to overlay
            the footer (Add To Cart button) in the next page (Item Detail page)
         -->
        <!-- <div data-role="footer" data-position="fixed">
            <h4 style="text-align:center;">I'm the footer</h4>
            <div style="display: flex;">

            </div>
        </div> -->
        <script>
            const { utils, datastore } = app;
            var vendor = {};

            function setVendorDetails({ vendorName, vendorImageLocation, location, deliveryTime, vendorRatings, items }) {

                $('#vendor-page-vendor-title').text(vendorName);
                $('#vendor-page-vendor-location').text(location);
                $('#vendor-page-vendor-delivery-time').text(`(${deliveryTime})`);
                $('#vendor-page-vendor-rating-value').text(vendorRatings.vendorRatingValue);
                $('#vendor-page-vendor-no-of-ratings').text(vendorRatings.vendorNoOfRatings);
                $('#vendor-page-vendor-image').attr('src', vendorImageLocation);

                // render items in order summary
                const itemCards = items.map(({ itemId, itemImageLocation, itemTitle, itemDescription, itemRatings, itemPrice }) => {
                    var markup =
                        `<div class="item_poi_container" item-id="${itemId}">
                            <div>
                                <img src=${itemImageLocation}>
                            </div>
                            <div class="poi_text_content">
                                <div class="poi_details">
                                    <div class="poi_title_description">
                                        <p id="poi_title">${itemTitle}</p>
                                        <p id="poi_description">${itemDescription}</p>
                                    </div>
                                    <div class="poi_ratings_bar">
                                        <p id="poi_ratings_text"><svg id="poi_ratings_image" width="12" height="11"
                                                viewBox="0 0 12 11" fill="none" xmlns="http://www.w3.org/2000/svg">
                                                <path
                                                    d="M6 0L7.34708 4.1459H11.7063L8.17963 6.7082L9.52671 10.8541L6 8.2918L2.47329 10.8541L3.82037 6.7082L0.293661 4.1459H4.65292L6 0Z"
                                                    fill="#F2C94C" />
                                            </svg>&nbsp;&nbsp;${itemRatings.itemRatingValue}&nbsp;
                                        <p>(${itemRatings.itemNoOfRatings})</p>
                                        </p>
                                    </div>
                                </div>
                                <div class="poi_price_tag">
                                    <p id="poi_price">LKR ${itemPrice}</p>
                                </div>
                            </div>
                        </div>`;
                    return markup;
                });

                // Concatenate the item cards markup
                const allItemCardsMarkup = itemCards.reduce((markup, card) => markup + card);

                // Replace instead of appending to container
                // because jQuery Mobile caches pages
                $('#vendor-page-container').html(allItemCardsMarkup)

                // IMPORTANT: NOTE WHEN YOU REPLACE HTML THE LISTENERS ALSO BECOME OBSOLETE
                // THAT'S WHY THE LOGIC TO BIND TO THE CLICK LISTENER HAS BEEN ADDED HERE
                $(".item_poi_container").click(function () {
                    // Handle Item POI click event
                    var itemId = $(this).attr("item-id"); // which vendor card was clicked
                    $(":mobile-pagecontainer").pagecontainer("change", "item_detail.html", {
                        data: {
                            itemId,
                            vendorId: vendor.vendorId,
                        }
                    });
                });
            }

            $('body').on('pagebeforeshow', "#vendor-page", function (event, { toPage }) {
                const url = toPage[0].baseURI;
                const queryParams = utils.parseUrlForQueryParams(url);
                const vendorDetails = datastore.getSpecificVendor(queryParams.vendorId);
                vendor = vendorDetails;
                setVendorDetails(vendor);
            });
        </script>
    </div>
</body>

</html>