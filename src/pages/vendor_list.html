<!DOCTYPE html>
<html>

<head>
    <title>Feed U - Home Page - Vendor List Page</title>

    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="stylesheet" href="../css/base.css" />
    <script src="../bundle.js"></script>

    <style>
        .ui-select {
            width: 100px !important;
            position: relative !important;
            top: -35px !important;
            left: 30px !important;
        }

        .ui-btn-corner-all,
        .ui-btn.ui-corner-all,
        .ui-slider-track.ui-corner-all,
        .ui-flipswitch.ui-corner-all,
        .ui-li-count {
            border-radius: 20px !important;
            font-size: 12px;
            color: white;
            background-color: #EB5757;
            position: relative;
            top: 17px;
            height: 10px;
        }

        .ui-btn-icon-left:after,
        .ui-btn-icon-right:after,
        .ui-btn-icon-top:after,
        .ui-btn-icon-bottom:after,
        .ui-btn-icon-notext:after {

            background-color: transparent;
        }

        .ui-btn-corner-all,
        .ui-btn.ui-corner-all,
        .ui-slider-track.ui-corner-all,
        .ui-flipswitch.ui-corner-all,
        .ui-li-count:active {
            border-radius: 20px !important;
            font-size: 12px !important;
            color: white !important;
            background-color: #EB5757 !important;
            position: relative !important;
            top: 17px !important;
            height: 10px !important;
        }
    </style>
</head>

<body>
    <div data-role="page" id="Page1">
        <div role="main" class="ui-content">
            <div style="display: flex; background-color: #E5E5E5;border-radius: 20px;width: 100%;height: 35px">
                <div class="filter">
                    <!-- filter img icon -->
                    
                    <i class="fa fa-filter" aria-hidden="true" style="color:#EB5757"></i>
                    <!-- /////////////// -->
                    
                    <div>
                        <!-- <fieldset class="ui-field-contain" style=""> -->
                    
                            <select name="select-choice-1" id="select-choice-1">
                                <option value="sort" disabled selected="selected">Sort</option>
                                <option value="a-z">A - Z</option>
                                <option value="rating">Rating</option>
                                <option value="deliverytime">Delivery Time</option>
                            </select>
                        <!-- </fieldset> -->
                    </div>
                    <div >
                        <!-- <fieldset class="ui-field-contain" style=""> -->
                            <select name="select-choice-1" id="select-choice-1">
                                <option value="ratings" disabled selected="selected">Ratings</option>
                                <option value=">3">> 3</option>
                                <option value=">4">> 4</option>
                                <option value=">5">> 5</option>
                                <option value="none">None</option>
                            </select>
                        <!-- </fieldset> -->
                    </div>
                    <div >
                    <!-- <fieldset class="ui-field-contain" style=""> -->

                        <select name="select-choice-1" id="select-choice-1">
                            <option value="deliverytime1" disabled selected="selected">Delivery Time</option>
                            <option value=">3">> 2 hour</option>
                            <option value=">4">> 1 hour</option>
                            <option value=">5">> 30 mins</option>
                        </select>
                    </div>
                    <!-- </fieldset> -->
                </div>
            </div>
            <br>
            <br>

            <div id="vendor-list-container" class="all-poi-container">
            </div>
        </div>
        <script>
            const { datastore } = app;

            var vendors = datastore.getAllVendors(); // TODO refactor this once mock data is removed

            // render items in order summary
            vendors.forEach(({ vendorId, vendorImageLocation, vendorName, vendorCatergories, vendorRatings, deliveryTime }) => {
                var markupP1 = `<div class="poi-container" vendor-id="${vendorId}">
                    <img src=${vendorImageLocation} class="poi-image">
                    <div class="poi-details">
                        <div>${vendorName}</div>
                        <div class="poi-catergory-container">`
                var markupP2 = ``
                var i = 0;
                vendorCatergories.forEach((category) => {
                    if (i === 0) {
                        markupP2 = markupP2 + `<i class="fa fa-circle" id="poi-catergory"></i>${category}`
                    } else {
                        markupP2 = markupP2 + `<i class="fa fa-circle" id="poi-catergory" style="margin-left: 2em;"></i>${category}`
                    }
                    i = i + 1;
                });
                var markupP3 =
                    `</div>
                        <div class="poi-rating-bar-container">
                            <div class="poi-rating-bar">
                                <span><i class='fa fa-star fa-fw' id="poi-rate-star-icon"></i> ${vendorRatings.vendorRatingValue} 
                                </span>
                                <small id="poi-no-of-rated-customers">(${vendorRatings.vendorNoOfRatings})</small>
                            </div>
                            <div id="poi-delivery-time">${deliveryTime}</div>
                        </div>
                    </div>
                </div>`
                var markup = markupP1 + markupP2 + markupP3;
                $('#vendor-list-container').append(markup)
            });

            $('body').on("pagecontainershow", function (event, ui) {
                // This event will get fired each time the pagecontainershow event fires,
                // that means it'll fire even when loading another page (other than home.html)

                var activePage = ui.toPage[0].id;
                if (activePage === 'home') {
                    // Retrieve user location from cookie and set to label
                    $("#user-home-delivery-location").text(user.getDetails().location.display);
                }
            });
            // Handle Vendor POI click event
            // https://stackoverflow.com/questions/943987/add-jquery-click-handler-to-multiple-elements
            $(".poi-container").click(function () {
                var vendorId = $(this).attr("vendor-id"); // which vendor card was clicked
                $(":mobile-pagecontainer").pagecontainer("change", "vendor_page.html", {
                    data: {
                        vendorId
                    }
                });
            });

            $("#home-footer").on("click", function (event) {
                $(":mobile-pagecontainer").pagecontainer("change", "checkout.html");
            });
        </script>
    </div>
</body>

</html>